<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Admin">

	<sql id="where">
		<where>
			<if test="searchString != '' and searchString != null">
				<if test="searchColumn == 'aId'">
					pk_admin_id like CONCAT('%', #{searchString}, '%')
				</if>				
				<if test="searchColumn == 'aName'">
					fd_admin_name like CONCAT('%', #{searchString}, '%')
				</if>
			</if>
		</where>  	
	</sql>

	<select id="get" parameterType="HashMap" resultType="Admin">
		SELECT * FROM tbl_admin WHERE pk_admin_id = #{pk_admin_id}
	</select>
	
	<select id="getCount"  parameterType="HashMap" resultType="int">
		SELECT COUNT(*) AS cnt FROM tbl_admin <include refid="where"/> 
	</select>
	
	<!-- <select id="getList" parameterType="HashMap" resultType="Admin">	
		SELECT * 
		FROM
		(
			SELECT 
					rownum AS num
				,	pk_admin_id
				,	fd_admin_pw
				,	fd_admin_name
				,	fd_admin_level_cd
				,	fd_company
				,	fd_team
				,	fd_memo
				,	fd_admin_status_cd
				,	fd_mobile
				,	fd_phone
				,	fd_email
				,	fd_reg_date
				,	fd_login_date
				,	fd_change_pw_date
				,	fd_login_ip
			
			FROM
			(
				SELECT 
					*
				FROM tbl_admin <include refid="where"/> 
				ORDER BY fd_reg_date DESC
			)
		) tbl_admin WHERE num BETWEEN (#{page} - 1) * #{pageSize} + 1 AND #{page} * #{pageSize}
	</select>-->
	
	<select id="getList" parameterType="HashMap" resultType="Admin">	
	  	SELECT * 
	    FROM tbl_admin <include refid="where"/> 
  	    ORDER BY fd_reg_date DESC 
	    limit #{pageStart}, #{pageSize}
	</select>
	
	<insert id="register" parameterType="Admin">
		INSERT INTO tbl_admin
		(
			pk_admin_id
		,	fd_admin_pw
		,	fd_admin_name
		,	fd_admin_level_cd
		,	fd_team
		,	fd_mobile
		,	fd_phone
		,	fd_email
		,	fd_reg_date
		,	fd_login_date
		,	fd_login_ip
		,	fd_admin_status_cd
		)
		VALUES
		(
			#{pk_admin_id}
		,	#{fd_admin_pw}
		,	#{fd_admin_name}
		,	#{fd_admin_level_cd}
		,	#{fd_team}
		,	#{fd_mobile}			
		,	#{fd_phone}
		,	#{fd_email}
		,	#{fd_reg_date}
		,	#{fd_login_date}
		,	#{fd_login_ip}
		,	#{fd_admin_status_cd}
		)
	</insert>

	<update id="modify"  parameterType="Admin">
		UPDATE tbl_admin
		<trim prefix="SET" prefixOverrides=",">
			<if test="fd_admin_pw != '' and fd_admin_pw != null">, fd_admin_pw = #{fd_admin_pw}</if>
			<if test="fd_admin_name != '' and fd_admin_name != null">, fd_admin_name = #{fd_admin_name}</if>
			<if test="fd_admin_level_cd != '' and fd_admin_level_cd != null">, fd_admin_level_cd = #{fd_admin_level_cd}</if>
			<if test="fd_team != '' and fd_team != null">, fd_team = #{fd_team}</if>
			<if test="fd_admin_status_cd != '' and fd_admin_status_cd != null">, fd_admin_status_cd = #{fd_admin_status_cd}</if>
			<if test="fd_email != '' and fd_email != null">, fd_email = #{fd_email}</if>
			<if test="fd_mobile != '' and fd_mobile != null">, fd_mobile = #{fd_mobile}</if>
			<if test="fd_phone != '' and fd_phone != null">, fd_phone = #{fd_phone}</if>
			<if test="fd_reg_date != '' and fd_reg_date != null">, fd_reg_date = #{fd_reg_date}</if>
			<if test="fd_login_date != '' and fd_login_date != null">, fd_login_date = #{fd_login_date}</if>
			<if test="fd_login_ip != '' and fd_login_ip != null">, fd_login_ip = #{fd_login_ip}</if>
			<if test="fd_change_pw_date != '' and fd_change_pw_date != null">, fd_change_pw_date = #{fd_change_pw_date}</if>	
		</trim> 
		WHERE pk_admin_id = #{pk_admin_id}
	</update>
	
	<delete id="remove"  parameterType="int">
		DELETE FROM tbl_admin WHERE pk_admin_id = #{pk_admin_id}
	</delete>
</mapper>